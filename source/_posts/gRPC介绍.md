---
title: gRPC介绍
categories:
  - RPC
  - gRPC
tags:
  - RPC
  - gRPC
date: 2021-03-31 09:22:42
---

### gRPC与RPC

`gRPC`是什么可以用官网的一句话来概括

> A high-performance, open-source universal RPC framework

**所谓RPC(remote procedure call 远程过程调用)框架实际是提供了一套机制，使得应用程序之间可以进行通信，而且也遵从server/client模型。使用的时候客户端调用server端提供的接口就像是调用本地的函数一样。**如下图所示就是一个典型的RPC结构图。

<img src="https://www.cmdbyte.com/2021/02/grpc%E4%BB%8B%E7%BB%8D.png" alt="grpc介绍" style="zoom:50%;" />

### gRPC vs Restful API

既然`RPC`也是`server/client`模型，那么和`Restful API`有什么区别呢？

`gRPC`和`Restful API`都提供了一套通信机制，用于`server/client`模型通信，而且它们都使用`http`作为底层的传输协议(严格地说, gRPC使用的http2.0，而`Restful API`则不一定)。不过`gRPC`还是有些特有的优势，如下：

- `gRPC`可以通过`protobuf`来定义接口，从而可以有更加严格的接口约束条件。
- 通过`protobuf`可以将数据序列化为二进制编码，这会大幅减少需要传输的数据量，从而大幅提高性能。
- `gRPC`可以方便地支持流式通信(理论上通过`http2.0`就可以使用`streaming`模式, 但是通常web服务的restful api似乎很少这么用，通常的流式数据应用如视频流，一般都会使用专门的协议如`HLS`，`RTMP`等，这些就不是我们通常web服务了，而是有专门的服务器应用。）

### 使用场景

- 需要对接口进行严格约束的情况，比如我们提供了一个公共的服务，很多人，甚至公司外部的人也可以访问这个服务，这时对于接口我们希望有更加严格的约束，我们不希望客户端给我们传递任意的数据，尤其是考虑到安全性的因素，我们通常需要对接口进行更加严格的约束。这时`gRPC`就可以通过`protobuf`来提供严格的接口约束。
- 对于性能有更高的要求时。有时我们的服务需要传递大量的数据，而又希望不影响我们的性能，这个时候也可以考虑`gRPC`服务，因为通过`protobuf`我们可以将数据压缩编码转化为二进制格式，通常传递的数据量要小得多，而且通过`http2`我们可以实现异步的请求，从而大大提高了通信效率。

但是，通常我们不会去单独使用`gRPC`，而是将`gRPC`作为一个部件进行使用，这是因为在生产环境，我们面对大并发的情况下，需要使用分布式系统来去处理，而gRPC并没有提供分布式系统相关的一些必要组件。而且，真正的线上服务还需要提供包括负载均衡，限流熔断，监控报警，服务注册和发现等等必要的组件。
